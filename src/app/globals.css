@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --radius: 0.625rem;
  --background: oklch(1 0 0);
  --foreground: oklch(0.1 0 0);
  --card: oklch(0.98 0 0);
  --card-foreground: oklch(0.1 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.1 0 0);
  --primary: oklch(0.15 0 0);
  --primary-foreground: oklch(0.98 0 0);
  --secondary: oklch(0.96 0 0);
  --secondary-foreground: oklch(0.1 0 0);
  --muted: oklch(0.96 0 0);
  --muted-foreground: oklch(0.4 0 0);
  --accent: oklch(0.96 0 0);
  --accent-foreground: oklch(0.1 0 0);
  --destructive: oklch(0.5 0.3 25);
  --border: oklch(0.88 0 0);
  --input: oklch(0.88 0 0);
  --ring: oklch(0.6 0 0);
  --chart-1: oklch(0.646 0.222 41.116);
  --chart-2: oklch(0.6 0.118 184.704);
  --chart-3: oklch(0.398 0.07 227.392);
  --chart-4: oklch(0.828 0.189 84.429);
  --chart-5: oklch(0.769 0.188 70.08);
  --sidebar: oklch(0.985 0 0);
  --sidebar-foreground: oklch(0.145 0 0);
  --sidebar-primary: oklch(0.205 0 0);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.97 0 0);
  --sidebar-accent-foreground: oklch(0.205 0 0);
  --sidebar-border: oklch(0.922 0 0);
  --sidebar-ring: oklch(0.708 0 0);
}

.dark {
  --background: oklch(0.11 0 0);
  --foreground: oklch(0.95 0 0);
  --card: oklch(0.17 0 0);
  --card-foreground: oklch(0.95 0 0);
  --popover: oklch(0.17 0 0);
  --popover-foreground: oklch(0.95 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --secondary: oklch(0.22 0 0);
  --secondary-foreground: oklch(0.95 0 0);
  --muted: oklch(0.22 0 0);
  --muted-foreground: oklch(0.65 0 0);
  --accent: oklch(0.24 0 0);
  --accent-foreground: oklch(0.95 0 0);
  --destructive: oklch(0.704 0.191 22.216);
  --border: oklch(1 0 0 / 15%);
  --input: oklch(1 0 0 / 15%);
  --ring: oklch(0.556 0 0);
  --chart-1: oklch(0.488 0.243 264.376);
  --chart-2: oklch(0.696 0.17 162.48);
  --chart-3: oklch(0.769 0.188 70.08);
  --chart-4: oklch(0.627 0.265 303.9);
  --chart-5: oklch(0.645 0.246 16.439);
  --sidebar: oklch(0.205 0 0);
  --sidebar-foreground: oklch(0.985 0 0);
  --sidebar-primary: oklch(0.488 0.243 264.376);
  --sidebar-primary-foreground: oklch(0.985 0 0);
  --sidebar-accent: oklch(0.269 0 0);
  --sidebar-accent-foreground: oklch(0.985 0 0);
  --sidebar-border: oklch(1 0 0 / 10%);
  --sidebar-ring: oklch(0.556 0 0);
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }

  /* Markdown code block styling */
  .prose code {
    @apply bg-muted px-1 py-0.5 rounded text-sm;
  }

  .prose pre {
    @apply border border-border;
    background-color: color-mix(in oklch, var(--background) 50%, transparent);
  }

  .prose pre code {
    @apply bg-transparent p-0;
  }
}

@layer utilities {
  /* Responsive sidebar utilities */
  @media (max-width: 768px) {
    .sidebar-mobile-hidden {
      display: none;
    }
  }

  /* Ensure content doesn't overflow on small screens */
  .responsive-grid {
    @apply grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4;
  }
}

/* Custom scrollbar styles for ticket lanes */
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}

.scrollbar-thin::-webkit-scrollbar {
  height: 6px;
}

.scrollbar-thin::-webkit-scrollbar-track {
  background: transparent;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  background-color: var(--border);
  border-radius: 3px;
}

.scrollbar-thin:hover::-webkit-scrollbar-thumb {
  background-color: var(--muted-foreground);
}

/* Animated RGB border for processing tickets */
@keyframes rgb-border-spin {
  0% {
    --border-angle: 0deg;
  }
  100% {
    --border-angle: 360deg;
  }
}

@property --border-angle {
  syntax: "<angle>";
  initial-value: 0deg;
  inherits: false;
}

.rgb-processing-border {
  position: relative;
  background: var(--card);
  border: 1px solid transparent;
  background-clip: padding-box;
}

.rgb-processing-border::before {
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: calc(var(--radius) + 2px);
  padding: 2px;
  background: conic-gradient(
    from var(--border-angle),
    #ff0080,
    #7928ca,
    #0070f3,
    #00dfd8,
    #7928ca,
    #ff0080
  );
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  animation: rgb-border-spin 3s linear infinite;
  pointer-events: none;
}

/* React Flow graph animations */
@keyframes graph-pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.5);
  }
  50% {
    box-shadow: 0 0 0 6px rgba(59, 130, 246, 0);
  }
}

@keyframes graph-pulse-amber {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.5);
  }
  50% {
    box-shadow: 0 0 0 6px rgba(245, 158, 11, 0);
  }
}

/* Pipeline step pulse animations */
.animate-pulse-blue {
  animation: graph-pulse 1.5s infinite;
}

.animate-pulse-amber {
  animation: graph-pulse-amber 1.5s infinite;
}

/* React Flow custom styling */
.react-flow__node {
  cursor: pointer;
}

.react-flow__node:focus {
  outline: none;
}

.react-flow__handle {
  width: 10px;
  height: 10px;
  border: 2px solid #18181b;
  background: #3f3f46;
}

.react-flow__edge-path {
  stroke-linecap: round;
}

/* Smooth edge animations */
.react-flow__edge.animated path {
  stroke-dasharray: 5;
  animation: dash 0.5s linear infinite;
}

@keyframes dash {
  to {
    stroke-dashoffset: -10;
  }
}

/* Ticket node selection glow - golden */
.ticket-selected-glow {
  filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.6)) drop-shadow(0 0 16px rgba(251, 191, 36, 0.3));
}

/* Ticket node processing border - subtle RGB flow */
@keyframes rgb-border-flow {
  0% {
    --border-angle: 0deg;
  }
  100% {
    --border-angle: 360deg;
  }
}

.ticket-processing-border {
  position: relative;
  border-radius: 10px;
}

.ticket-processing-border::before {
  content: "";
  position: absolute;
  inset: -3px;
  border-radius: 12px;
  padding: 3px;
  background: conic-gradient(
    from var(--border-angle),
    rgba(147, 51, 234, 0.5),
    rgba(59, 130, 246, 0.5),
    rgba(16, 185, 129, 0.5),
    rgba(245, 158, 11, 0.5),
    rgba(239, 68, 68, 0.5),
    rgba(147, 51, 234, 0.5)
  );
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  animation: rgb-border-flow 3s linear infinite;
  pointer-events: none;
  opacity: 0.7;
}

/* Combined state - processing takes precedence for border, but add glow too */
.ticket-processing-border.ticket-selected-glow::before {
  opacity: 0.9;
}
